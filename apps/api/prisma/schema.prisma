generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       String    @id
  name     String
  email    String    @unique
  password String
  city     String
  role     String    @default("USER") // USER, ADMIN
  requests Request[]
}

model Resource {
  id           String       @id
  resourceType String
  capacity     Int
  city         String
  status       String       @default("AVAILABLE")
  allocations  Allocation[]
}

model Request {
  id          String      @id @default(cuid())
  userId      String
  user        User        @relation(fields: [userId], references: [id])
  service     String
  requestType String
  urgency     String
  status      String      @default("PENDING")
  createdAt   DateTime    @default(now())
  allocation  Allocation?
}

model Allocation {
  id            String   @id @default(cuid())
  requestId     String   @unique
  request       Request  @relation(fields: [requestId], references: [id])
  resourceId    String
  resource      Resource @relation(fields: [resourceId], references: [id])
  priorityScore Int
  status        String   @default("ASSIGNED")
  timestamp     DateTime @default(now())
}

model AllocationRule {
  id        String  @id @default(cuid())
  condition String
  weight    Int
  isActive  Boolean @default(true)
}
